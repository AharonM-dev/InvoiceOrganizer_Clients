<div class="reports-container fade-in">
    <!-- Header & Actions -->
    <div class="flex flex-column md:flex-row justify-content-between align-items-start md:align-items-center header-section">
      <div>
        <h1>ניתוח הוצאות</h1>
        <p>מבט על הביצועים הפיננסים שלך</p>
      </div>
      <div class="flex gap-3 mt-3 md:mt-0">
        <p-datepicker [(ngModel)]="dateRange" selectionMode="range" [readonlyInput]="true" placeholder="סינון לפי תאריך"
          styleClass="premium-calendar"></p-datepicker>
        <p-button label="Excel" icon="pi pi-file-excel" styleClass="p-button-outlined p-button-success"></p-button>
        <p-button label="PDF" icon="pi pi-file-pdf" styleClass="p-button-outlined p-button-danger"></p-button>
      </div>
    </div>
  
    <!-- KPI Cards -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8 kpi-grid">
      <!-- Total Spend -->
      <div>
        <p-card styleClass="premium-card kpi-card" [style]="{'--kpi-color': '#3b82f6'}">
          <div class="flex justify-between items-start">
            <div>
              <span class="block kpi-label mb-2">סה"כ הוצאות</span>
              <div class="kpi-value">{{ totalSpend | currency:'ILS':'symbol':'1.0-0' }}</div>
              <div class="text-green-400 text-sm mt-2 font-bold flex items-center gap-1">
                <i class="pi pi-arrow-up text-xs"></i> 2.5% מהחודש שעבר
              </div>
            </div>
            <div class="kpi-icon-wrapper">
              <i class="pi pi-wallet text-blue-400 text-2xl"></i>
            </div>
          </div>
        </p-card>
      </div>

      <!-- Monthly Average -->
      <div>
        <p-card styleClass="premium-card kpi-card" [style]="{'--kpi-color': '#a855f7'}">
          <div class="flex justify-between items-start">
            <div>
              <span class="block kpi-label mb-2">ממוצע חודשי</span>
              <div class="kpi-value">{{ monthlyAverage | currency:'ILS':'symbol':'1.0-0' }}</div>
              <div class="text-gray-400 text-sm mt-2">מחושב שנתית</div>
            </div>
            <div class="kpi-icon-wrapper">
              <i class="pi pi-calendar text-purple-400 text-2xl"></i>
            </div>
          </div>
        </p-card>
      </div>

      <!-- Top Category -->
      <div>
        <p-card styleClass="premium-card kpi-card" [style]="{'--kpi-color': '#ec4899'}">
          <div class="flex justify-between items-start">
            <div>
              <span class="block kpi-label mb-2">קטגוריה מובילה</span>
              <div class="kpi-value text-xl">{{ topCategory }}</div>
              <div class="text-pink-400 text-sm mt-2 font-bold">{{ 1250 | currency:'ILS':'symbol':'1.0-0' }}</div>
            </div>
            <div class="kpi-icon-wrapper">
              <i class="pi pi-shopping-bag text-pink-400 text-2xl"></i>
            </div>
          </div>
        </p-card>
      </div>

      <!-- Savings -->
      <div>
        <p-card styleClass="premium-card kpi-card" [style]="{'--kpi-color': '#22c55e'}">
          <div class="flex justify-between items-start">
            <div>
              <span class="block kpi-label mb-2">חיסכון משוער</span>
              <div class="kpi-value">{{ savings | currency:'ILS':'symbol':'1.0-0' }}</div>
              <div class="text-green-400 text-sm mt-2 flex items-center gap-1">
                <i class="pi pi-check-circle text-xs"></i> מצב מצוין
              </div>
            </div>
            <div class="kpi-icon-wrapper">
              <i class="pi pi-chart-line text-green-400 text-2xl"></i>
            </div>
          </div>
        </p-card>
      </div>
    </div>
  
    <!-- Main Charts -->
    <div class="grid p-fluid">
      <!-- Monthly Trend -->
      <div class="col-12 mb-4">
        <p-card styleClass="premium-card h-full" header="מגמת הוצאות שנתית">
          <p class="text-gray-400 mb-4 text-sm px-3">פירוט הוצאות חודשי מתחילת השנה הנוכחית</p>
          <div class="px-2 pb-2">
            <p-chart type="line" [data]="monthlyTrendData" [options]="monthlyTrendOptions" height="400px"></p-chart>
          </div>
        </p-card>
      </div>
  
      <!-- Category Chart -->
      <div class="col-12 lg:col-6 mb-4 lg:mb-0">
        <p-card styleClass="premium-card h-full" header="התפלגות הוצאות">
          <div class="flex justify-content-center align-items-center h-full py-4">
            <p-chart type="doughnut" [data]="categoryData" [options]="categoryOptions" height="350px"></p-chart>
          </div>
        </p-card>
      </div>
  
      <!-- Top Vendors Chart -->
      <div class="col-12 lg:col-6">
        <p-card styleClass="premium-card h-full" header="ספקים עיקריים">
            <p class="text-gray-400 mb-2 text-sm px-3">חמשת הספקים עם ההוצאה המצטברת הגבוהה ביותר</p>
            <p-chart type="bar" [data]="topVendorsData" [options]="topVendorsOptions" height="350px"></p-chart>
        </p-card>
      </div>
    </div>
  </div>
